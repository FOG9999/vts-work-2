@using Viettel.Models.QLNH
@model ThongTinThanhToanDetaiModel

<div class="modal-body" style="max-height: calc(100vh - 185px); overflow-y: auto;">
    <div class="form-group row">
        <div class="col-sm-12">
            <h4 class="color-text-red">Thông tin chung</h4>
            <hr class='color-background-red' />
            <div class="form-group row">
                <div class="col-sm-2">
                    <label>Đơn vị</label>
                    @Helpers.Required()
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sTen))</p>
                </div>
                <div class="col-sm-2">
                    <label>Ngày đề nghị</label>
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.dNgayDeNghi.HasValue ? Model.thongtinthanhtoan.dNgayDeNghi.Value.ToString("dd/MM/yyyy") : string.Empty))</p>
                </div>
                <div class="col-sm-2">
                    <label>Số đề nghị</label>
                    @Helpers.Required()
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sSoDeNghi))</p>
                </div>
                <div class="col-sm-2">
                    <label>Loại nội dung</label>
                    @Helpers.Required()
                    @{
                        if (Model.thongtinthanhtoan.iLoaiNoiDungChi == 1)
                        {
                            <p>Chi ngoại tệ</p>
                        }
                        else
                        {
                            <p>Chi trong nước</p>
                        }
                    }
                </div>
                <div class="col-sm-2">
                    <label>Tên chương trình</label>
                    @Helpers.Required()
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sTenNhiemVuChi))</p>
                </div>
                <div class="col-sm-2">
                    <label>Chủ đầu tư</label>
                    @Helpers.Required()
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sTenCDT))</p>
                </div>
            </div>

            <div class="form-group row">
                <div class="col-sm-2">
                    <label>Thanh toán theo</label>
                    @Helpers.Required()
                    @{
                        if (Model.thongtinthanhtoan.iThanhToanTheo == 1)
                        {
                            <p>Nội dung chi theo hợp đồng</p>
                        }
                        else if (Model.thongtinthanhtoan.iThanhToanTheo == 2)
                        {
                            <p>Nội dung chi theo dự án, không hình thành hợp đồng</p>
                        }
                        else
                        {
                            <p>Nội dung chi không theo dự án, không hình thành hợp đồng</p>
                        }
                    }
                </div>
                @{
                    if (Model.thongtinthanhtoan.iThanhToanTheo == 1)
                    {
                        <div class="col-sm-2" id="dhopdong">
                            <label>Tên hợp đồng</label>
                            <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sTenHopDong))</p>
                        </div>
                        <div class="col-sm-2" id="dcancu">
                            <label>Căn cứ</label>
                            <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sCanCu))</p>
                        </div>
                        <div class="col-sm-2" id="dhodongusd">
                            <label>Giá trị hợp đồng được duyệt (USD)</label>
                            <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sHopDongPheDuyet_USD))</p>

                        </div>
                        <div class="col-sm-2" id="dhodongvnd">
                            <label>Giá trị hợp đồng được duyệt (VND)</label>
                            <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sHopDongPheDuyet_VND))</p>
                        </div>
                    }
                    else if (Model.thongtinthanhtoan.iThanhToanTheo == 2)
                    {
                        <div class="col-sm-2" id="dduan">
                            <label>Tên dự án</label>
                            <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sTenDuAn))</p>

                        </div>
                        <div class="col-sm-2" id="dcancu">
                            <label>Căn cứ</label>
                            <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sCanCu))</p>
                        </div>
                        <div class="col-sm-2" id="ddutoanusd">
                            <label>Giá trị dự toán được duyệt (USD)</label>
                            <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sDuToanPheDuyet_USD))</p>

                        </div>
                        <div class="col-sm-2" id="ddutoanvnd">
                            <label>Giá trị dự toán được duyệt (VND)</label>
                            <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sDuToanPheDuyet_VND))</p>
                        </div>
                    }
                    else
                    {
                        <div class="col-sm-2" id="dcancu">
                            <label>Căn cứ</label>
                            <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sCanCu))</p>
                        </div>
                    }
                }
            </div>
            <div class="form-group row">
                <div class="col-sm-2" style="margin-top:20px">
                    <label>Lũy kế kinh phí được cấp, thanh toán đến cuối kỳ trước (USD)</label>
                    <p>@Html.Raw(Html.Encode(ViewBag.sLuyKeUSD))</p>
                </div>
                <div class="col-sm-2" style="margin-top:20px">
                    <label>Lũy kế kinh phí được cấp, thanh toán đến cuối kỳ trước (VND)</label>
                    <p>@Html.Raw(Html.Encode(ViewBag.sLuyKeVND))</p>
                </div>
                <div class="col-sm-2" style="margin-top:20px">
                    <label>Loại đề nghị</label>
                    @Helpers.Required()
                    @{
                        if (Model.thongtinthanhtoan.iLoaiDeNghi == 1)
                        {
                            <p>Cấp kinh phí</p>
                        }
                        else if (Model.thongtinthanhtoan.iLoaiDeNghi == 2)
                        {
                            <p>Thanh toán</p>
                        }
                        else
                        {
                            <p>Tạm ứng</p>
                        }
                    }
                </div>
                <div class="col-sm-2" style="margin-top:20px">
                    <label>Quý kế hoạch</label>
                    @Helpers.Required()
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.iQuyKeHoach))</p>
                </div>
                <div class="col-sm-2" style="margin-top:20px">
                    <label>Năm kế hoạch</label>
                    @Helpers.Required()
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.iNamKeHoach))</p>
                </div>
                <div class="col-sm-2" style="margin-top:20px">
                    <label>Năm ngân sách</label>
                    @Helpers.Required()
                    @{
                        if (Model.thongtinthanhtoan.iNamNganSach == 1)
                        {
                            <p>Năm nay</p>
                        }
                        else
                        {
                            <p>Năm trước chuyển sang</p>
                        }
                    }
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-2">
                    <label>Cơ quan thanh toán</label>
                    @Helpers.Required()
                    @{
                        if (Model.thongtinthanhtoan.iCoQuanThanhToan == 1)
                        {
                            <p>CTC cấp</p>
                        }
                        else
                        {
                            <p>Đơn vị cấp</p>
                        }
                    }
                </div>
                <div class="col-sm-2">
                    <label>Tỉ giá đề nghị</label>
                    @Helpers.Required()
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sTiGiaDeNghi))</p>
                </div>
                <div class="col-sm-2">
                    <label>Tỉ giá phê duyệt</label>
                    @Helpers.Required()
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sTiGiaPheDuyet))</p>
                </div>
                <div class="col-sm-2">
                    <label>Trạng thái</label>
                    @Helpers.Required()
                    @{
                        if (Model.thongtinthanhtoan.iTrangThai == 1)
                        {
                            <p>Lưu nháp</p>
                        }
                        else if (Model.thongtinthanhtoan.iTrangThai == 2)
                        {
                            <p>Chưa được duyệt</p>
                        }
                        else
                        {
                            <p>Đã được duyệt</p>
                        }
                    }
                </div>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-sm-12">
            <h4 class="color-text-red">Thông tin thanh toán</h4>
            <hr class='color-background-red' />
            <table class="table table-bordered scrolldown" id="tblListTTThanhToan">
                <thead>
                    <tr>
                        <th rowspan="2" width="20%">Mục lục ngân sách</th>
                        <th rowspan="2" width="20%">Nội dung chi</th>
                        <th width="30%" colspan="2">Số kinh phí đề nghị thanh toán kỳ này</th>
                        <th width="30%" colspan="2">Số kinh phí chấp nhận phê duyệt thanh toán kỳ này</th>

                    </tr>
                    <tr>
                        <th width="15%">USD</th>
                        <th width="15%">VND</th>
                        <th width="15%">USD</th>
                        <th width="15%">VND</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.thanhtoan_chitiet)
                    {
                        <tr>
                            <td class="text-center">@Html.Raw(Html.Encode(item.sMucLucNganSach))</td>
                            <td class="text-left">@Html.Raw(Html.Encode(item.sTenNoiDungChi))</td>
                            <td class="text-right">@Html.Raw(Html.Encode(item.sDeNghiCapKyNay_USD))</td>
                            <td class="text-right">@Html.Raw(Html.Encode(item.fDeNghiCapKyNay_VND.HasValue ? item.fDeNghiCapKyNay_VND.Value.ToString("###, ###") : string.Empty))</td>
                            <td class="text-right">@Html.Raw(Html.Encode(item.sPheDuyetCapKyNay_USD))</td>
                            <td class="text-right">@Html.Raw(Html.Encode(item.fPheDuyetCapKyNay_VND.HasValue ? item.fPheDuyetCapKyNay_VND.Value.ToString("###,###") : string.Empty))</td>
                        </tr>
                    }

                </tbody>
                <tfoot>
                    <tr>
                        <th class="text-bold text-right" colspan="2">Tổng cộng</th>
                        <th class="text-bold text-right">@Html.Raw(Html.Encode(ViewBag.sTongDeNghi_USD))</th>
                        <th class="text-bold text-right">@Html.Raw(Html.Encode(Model.thongtinthanhtoan.fTongCTDeNghiCapKyNay_VND.HasValue ? Model.thongtinthanhtoan.fTongCTDeNghiCapKyNay_VND.Value.ToString("###,###") : string.Empty))</th>
                        <th class="text-bold text-right">@Html.Raw(Html.Encode(ViewBag.sTongPheDuyet_USD))</th>
                        <th class="text-bold text-right">@Html.Raw(Html.Encode(Model.thongtinthanhtoan.fTongCTPheDuyetCapKyNay_VND.HasValue ? Model.thongtinthanhtoan.fTongCTPheDuyetCapKyNay_VND.Value.ToString("###,###") : string.Empty))</th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-sm-12">
            <h4 class="color-text-red">Thông tin đơn vị hưởng thụ</h4>
            <hr class='color-background-red' />
            <div class="form-group row">
                <div class="col-sm-2">
                    <label>Tên đơn vị hưởng thụ</label>
                    @Helpers.Required()
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sTenNhaThau))</p>
                </div>
                <div class="col-sm-2">
                    <label>Chuyển khoản (bằng số)</label>
                    @Helpers.Required()
                    @if (Model.thongtinthanhtoan.iLoaiNoiDungChi == 1)
                    {
                        <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan._sChuyenKhoan_BangSo_USD))</p>
                    }
                    else
                    {
                        <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan._sChuyenKhoan_BangSo_VND))</p>
                    }


                </div>
                <div class="col-sm-2">
                    <label>Bằng chữ</label>
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sChuyenKhoan_BangChu))</p>
                </div>
                <div class="col-sm-2">
                    <label>Số tài khoản</label>
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sSoTaiKhoan))</p>
                </div>
                <div class="col-sm-2">
                    <label>Tại</label>
                    <p>@Html.Raw(Html.Encode(Model.thongtinthanhtoan.sNganHang))</p>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal-footer">
    <div class="text-center">
        <button class="btn btn-default" data-dismiss="modal"><i class="fa fa-ban" aria-hidden="true"></i><span>Quay lại</span></button>
    </div>
</div>
